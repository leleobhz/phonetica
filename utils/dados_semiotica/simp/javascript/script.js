function inserir_apos(pai,elemento,referencia){if(referencia.nextSibling){pai.insertBefore(elemento,referencia.nextSibling);}else{pai.appendChild(elemento);}}function inserir_inicio(pai,elemento){if(pai.hasChildNodes()){pai.insertBefore(elemento,pai.firstChild);}else{pai.appendChild(elemento);}}function and(a,b){return a&&b;}function lt(a,b){return a<b;}function le(a,b){return a<=b;}function gt(a,b){return a>b;}function ge(a,b){return a>=b;}window.onload=iniciar;window.onkeydown=checar_tecla;{var url_atual="";var foco=true;var timer_foco=false;var timer_hora=false;var input_busca=false;var timer_busca=false;var limite_tamanho=250;var checkbox_marcados=new Array();class_tremer.instancias=new Array();class_piscar.instancias=new Array();class_fechar.instancias=new Array();}function iniciar(foco){if(timer_foco&&timer_hora){clearInterval(timer_foco);clearTimeout(timer_hora);}definir_atributos();if(foco){timer_foco=window.setTimeout("set_foco();",700);}timer_hora=window.setInterval("atualizar_hora();",1000);var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){var src=scripts.item(i).getAttribute("src");if(src!=script_local){var conteudo=get_conteudo(src);eval(conteudo);}}return true;}function checar_tecla(e){var k=e.keyCode?e.keyCode:e.which;switch(k){case 116:var url=(url_atual!="")?url_atual:window.location.href;if(url.indexOf("xml=1")>-1){var vt_url=url.split("?");url=vt_url.shift()+"?";var vt_param=vt_url[0].split("&");var parametros=new Array();for(var i=0;i<vt_param.length;i++){if(vt_param[i]!="xml=1"){parametros.push(vt_param[i]);}}url=url+parametros.join("&");}window.location.replace(url);return false;}return true;}function class_ajax(){var that=this;this.flag_erro=true;this.xmlhttp=null;this.url=null;this.usuario=null;this.senha=null;this.funcao=null;this.carregando=null;this.set_credencial=function(usuario,senha){that.usuario=usuario;that.senha=senha;};this.set_funcao=function(funcao){that.funcao=funcao;};this.consultar=function(metodo,url,assincrona,dados,flag_erro){that.url=url;if(!that.xmlhttp){window.location.replace(url);return false;}if(!dados){dados=null;}if(flag_erro!=undefined){that.flag_erro=flag_erro;}try{var url_requisicao=that.url+(that.url.indexOf("?")>=0?"&":"?")+"xml=1";if(that.usuario&&that.senha){that.xmlhttp.open(metodo.toUpperCase(),url_requisicao,assincrona,that.usuario,that.senha);}else{that.xmlhttp.open(metodo.toUpperCase(),url_requisicao,assincrona);}that.xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");that.xmlhttp.onreadystatechange=this.processar;that.xmlhttp.send(dados);}catch(e){window.alert("Erro ao consultar site: "+e.message);return false;}return true;};this.criar_carregando=function(){if(that.div_carregando){return that.div_carregando.cloneNode(1);}var div=document.createElement("div");div.style.visibility='hidden';definir_classe(div,"carregando");{var img=document.createElement("img");img.setAttribute("src",wwwroot+"imgs/icones/carregando.gif");var texto=document.createTextNode("Carregando...");}if(img!=undefined){div.appendChild(img);}div.appendChild(texto);div.onclick=that.retirar_carregando;that.div_carregando=div.cloneNode(1);return div;};this.exibir_carregando=function(elemento){var div=this.criar_carregando();if(elemento){if(typeof elemento!="number"){tirar_visibilidade(elemento);div.style.position="absolute";div.style.left="inherit";div.style.top="inherit";inserir_inicio(elemento,div);}else{document.getElementsByTagName("body").item(0).appendChild(div);}}div.style.visibility='visible';that.carregando=div;};this.retirar_carregando=function(){if(that.carregando==null||that.carregando.parentNode==null){return;}that.carregando.parentNode.removeChild(that.carregando);delete that.carregando;that.carregando=null;};this.processar=function(){if(that.xmlhttp.readyState==4){switch(that.xmlhttp.status){case 200:that.funcao();break;case 503:if(that.flag_erro){window.alert("O sistema está operando acima do esperado.\nRecomenda-se sair e voltar mais tarde.");}break;default:if(that.flag_erro){window.alert("Erro "+that.xmlhttp.status+": "+that.xmlhttp.statusText);}break;}if(that.carregando){that.retirar_carregando();}}};this.criar_xmlhttp=function(){if(window.XMLHttpRequest){return new XMLHttpRequest();}else if(window.ActiveXObject){var versoes=["MSXML2.XMLHttp","MSXML.XMLHttp","Microsoft.XMLHttp"];for(var i=0;i<versoes.length;i++){try{return new ActiveXObject(versoes[i]);}catch(e){}}}return false;};this.get_retorno=function(tipo,opcao){switch(tipo.toLowerCase()){case "xml":return that.xmlhttp.responseXML;case "text":return that.xmlhttp.responseText;case "headers":return that.xmlhttp.getAllResponseHeaders();case "header":return that.xmlhttp.getResponseHeader(opcao);}return false;};this.xmlhttp=this.criar_xmlhttp();}function submeter(form,carregando){if(msie){return true;}var centro=document.getElementById("centro");var ajax=new class_ajax();if(!centro||!ajax.xmlhttp){return true;}var url=form.getAttribute("action");var dados=get_dados(form);var metodo=form.getAttribute("method");if(carregando!=undefined){ajax.exibir_carregando(carregando);}if(metodo.toLowerCase()=="get"){url=url+(url.indexOf("?")>=0?"&":"?")+dados;}ajax.set_funcao(atualizar);ajax.consultar(metodo,url,true,dados);return false;}function carregar(link,carregando,setar_foco){if(msie){return true;}setar_foco=(setar_foco==undefined)?false:setar_foco;var url=link.getAttribute("href");var centro=document.getElementById("centro");var ajax=new class_ajax();if(!centro||!ajax.xmlhttp){window.location.replace(url);return true;}if(carregando!=0){ajax.exibir_carregando(carregando);}if(url.indexOf('http:')<0){url=wwwroot+url;}ajax.foco=setar_foco;ajax.set_funcao(atualizar);ajax.consultar("GET",url,true,null);return false;}function get_dados(form){var param=new Array();for(var i=0;i<form.elements.length;i++){var elemento=form.elements[i];if(elemento.name==undefined||elemento.disabled){continue;}switch(elemento.getAttribute("type")){case "checkbox":case "radio":if(elemento.checked){var parametro=elemento.name+"="+encodeURIComponent(elemento.value);param.push(parametro);}break;case "submit":if(elemento.getAttribute("clicou")=="1"){var parametro=elemento.name+"="+encodeURIComponent(elemento.value);param.push(parametro);}break;default:var parametro=elemento.name+"="+encodeURIComponent(elemento.value);param.push(parametro);break;}}return param.join("&");}function clonar(obj,limite){this.atualizar_clone=function(obj,sufixo){if(obj.nodeType!=1){return;}obj.def=0;try{if(obj.hasAttribute("id")){obj.id=obj.id+sufixo;}if(obj.hasAttribute("for")){obj.setAttribute("for",obj.getAttribute("for")+sufixo);}}catch(e){if(obj.getAttribute("id")){obj.setAttribute("id",obj.getAttribute("id")+sufixo);}if(obj.htmlFor){obj.htmlFor=obj.htmlFor+sufixo;}}if(obj.hasChildNodes()){var c=obj.firstChild;while(c!=null){that.atualizar_clone(c,sufixo);c=c.nextSibling;}}};this.atualizar_labels=function(obj){var padrao=that.get_label(obj);var c=obj.nextSibling;var i=2;while(c!=null&&c.clonado!=undefined){var label=that.get_label(c);var novo_label=document.createTextNode(padrao.nodeValue+" "+i);label.parentNode.replaceChild(novo_label,label);c=c.nextSibling;i++;}};this.get_label=function(obj){if(obj.nodeType==3&&get_tag(obj.parentNode)=="label"){return obj;}var f=obj.firstChild;while(f!=null){var l=that.get_label(f);if(l!=null){return l;}f=f.nextSibling;}return null;};this.get_ultimo=function(obj){var u=obj;var c=obj.nextSibling;var i=1;while(c!=null&&c.clonado!=undefined){u=c;c=c.nextSibling;i++;}return{obj:u,pos:i};};that=this;this.ultimo=this.get_ultimo(obj);if(!this.id){this.id=1;}this.id++;if(limite!=undefined&&this.ultimo.pos>=limite){window.alert("São permitidos no máximo "+limite+" elementos");return false;}var obj_clone=obj.cloneNode(true);obj_clone.clonado=true;obj_clone.original=obj;this.atualizar_clone(obj_clone,this.ultimo.pos+1);if(obj_clone.appendChild){var bt_remover=document.createElement("input");definir_classe(bt_remover,"botao");bt_remover.setAttribute("type","button");bt_remover.setAttribute("value","Remover");bt_remover.onclick=function(){var clone=this.parentNode;var original=clone.original;clone.parentNode.removeChild(clone);that.atualizar_labels(original);};obj_clone.appendChild(bt_remover);}var u=this.ultimo.obj;inserir_apos(u.parentNode,obj_clone,u);this.atualizar_labels(obj);iniciar();return true;}function atualizar(){url_atual=this.url;var head=document.getElementsByTagName("head").item(0);var nav=document.getElementById("navegacao");var centro=document.getElementById("centro");var xml=this.get_retorno("xml");if(!xml||!xml.documentElement||xml.getElementById('pagina_login')){window.location.replace(url_atual);return false;}var i=0;while(i<document.childNodes.length){var c=document.childNodes.item(i);if((c.nodeType==7)||(c.nodeType==8)){document.removeChild(c);}else{i++;}}for(i=xml.childNodes.length-1;i>=0;i--){var c=xml.childNodes.item(i);try{if(c.nodeType==7){if(c.sheet!=null){var j=0;for(j=0;j<c.sheet.media.length;j++){if(c.sheet.media.item(j)=="screen"){var novo=document.importNode(c,true);document.insertBefore(novo,document.firstChild);}}}else{var novo=document.importNode(c,true);document.insertBefore(novo,document.firstChild);}}else if(c.nodeType==8){var novo=document.importNode(c,true);document.appendChild(novo);}}catch(e){}}var vhead2=xml.documentElement.getElementsByTagName("head");if(vhead2){var head2=vhead2.item(0);var pai=head.parentNode;try{var novo=document.importNode(head2,true);pai.replaceChild(novo,head);}catch(e){var itens_head=head.childNodes;while(itens_head.length>0){head.removeChild(itens_head.item(0));}var itens_head2=head2.childNodes;for(i=0;i<itens_head2.length;i++){if(itens_head2.item(i).nodeType!=1){continue;}var item=clonar_tag(itens_head2.item(i));try{head.appendChild(item);}catch(e){window.alert("Erro: "+e.message+"\n\nRecomenda-se desabilitar o JavaScript.");}}}}var nav2=xml.getElementById("navegacao");if(nav2){var pai=nav.parentNode;try{var novo=document.importNode(nav2,true);pai.replaceChild(novo,nav);}catch(e){try{nav.innerHTML=nav2.innerHTML;}catch(e){window.alert("Erro ao atualizar barra de navegacao:\n"+e.message+"\n\nRecomenda-se desabilitar o Javascript");}}}var centro2=xml.getElementById("centro");if(centro2){var pai=centro.parentNode;try{var novo=document.importNode(centro2,true);pai.replaceChild(novo,centro);}catch(e){try{centro.innerHTML=centro2.innerHTML;}catch(e){window.alert("Erro ao atualizar o conteudo da pagina:\n"+e.message+"\n\nRecomenda-se desabilitar o Javascript");}}}else{var conteudo=xml.getElementById("conteudo");if(conteudo){limpar(centro);centro.appendChild(conteudo);}else{var body2=xml.documentElement.getElementsByTagName("body");if(body2){limpar(centro);centro.appendChild(body2.item(0))}else{window.alert("Documento incorreto");}}}document.title=document.getElementsByTagName("title").item(0).innerHTML;var id_body=xml.documentElement.getElementsByTagName("body").item(0).id;document.getElementsByTagName("body").item(0).id=id_body?id_body:"";iniciar(this.foco);return true;}function definir_atributos(){if(navegador=="firefox"){var objects=document.getElementsByTagName("object");if(objects&&objects.length){for(var i=0;i<objects.length;i++){object=objects.item(i);var pai=object.parentNode;c=object.cloneNode(true);document.importNode(c,true);pai.insertBefore(c,object);pai.removeChild(object);}}}var body=document.getElementsByTagName("body").item(0);var itens=body.getElementsByTagName("*");var tam=itens.length;var captcha=document.getElementById("captcha");if(captcha&&!captcha.def&&possui_classe(captcha.parentNode,"captcha_imagem")){try{var b=document.createElement("input");b.setAttribute("type","button");}catch(e){var b=document.createElement("<input type='button'/>");}b.setAttribute("value","Mudar imagem");b.setAttribute("title","Clique aqui em caso de dificuldade de leitura do texto da imagem");definir_classe(b,"botao");b.onclick=function(){var img=this.parentNode.getElementsByTagName("img").item(0);var vt=img.getAttribute("src").split("?");img.setAttribute("src",vt[0]+"?c="+Math.random());};captcha.parentNode.appendChild(b);captcha.def=1;}for(var i=0;i<tam;i++){var item=itens.item(i);if(item.def){continue;}var tag=get_tag(item);switch(get_classe(item)){case "drag":var item_movel=document.getElementById("drag_"+item.id);if(item_movel){objeto_movel(item,item_movel);}item.def=1;break;case "erro":if(tag=="div"){var obj_tremer=new class_tremer(item,4);obj_tremer.tremer(1000);}break;case "aviso":if(tag=="div"){var obj_piscar=new class_piscar(item,1,0.1);obj_piscar.piscar();}break;case "relacionamento":if(tag=="a"){var seletor=new class_seletor(item);item.def=1;}break;case "hierarquia":if(tag=="a"){var seletor=new class_hierarquia(item);item.def=1;}break;case "data":if(tag=="div"){var seletor_data=new class_calendario(item);item.def=1;}break;case "popup":if(tag=="a"){var popup=new class_popup(item);item.def=1;}break;case "botao":if(item.getAttribute("type")=="submit"){item.setAttribute("clicou","0");item.onclick=function(){this.setAttribute("clicou","1");return true;};var form=item.parentNode;while((get_tag(form)!="form")&&form.parentNode){form=form.parentNode;}if(get_tag(form)=="form"&&form.onsubmit){var novo=function(){var vt=this.getElementsByTagName('input');var i=0;for(i=0;i<vt.length;i++){var s=vt.item(i);if(s.getAttribute("clicou")=="1"){var h=document.createElement("input");h.setAttribute("type","hidden");h.setAttribute("name",s.getAttribute("name"));h.setAttribute("value",s.getAttribute("value"));this.appendChild(h);s.setAttribute("disabled","disabled");s.setAttribute("antes",s.getAttribute("value"));s.setAttribute("value","Aguarde");s.style.backgroundImage="url("+wwwroot+"imgs/icones/carregando_form.gif)";s.style.backgroundRepeat="no-repeat";}}};form.onsubmit=juntar_funcoes(form.onsubmit,novo);}}break;case "botao_clonar":var codigo="var elemento = "+item.getAttribute("alt")+";";eval(codigo);if(elemento){elemento.style.display="block";try{item.setAttribute("type","button");item.removeAttribute("alt");definir_classe(item,"botao");}catch(e){var novo_item=document.createElement("<input type='button'/>");novo_item.setAttribute("value",item.getAttribute("value"));novo_item.onclick=item.onclick;definir_classe(novo_item,"botao");item.parentNode.replaceChild(novo_item,item);}}item.def=1;break;}switch(item.getAttribute("rel")){case "blank":item.setAttribute("target","_blank");item.def=1;break;case "checar":if(tag=="a"){checar_link(item);item.def=1;}break;}}for(var i=0;i<document.forms.length;i++){var form=document.forms[i];var fields=form.getElementsByTagName("fieldset");for(var j=0;j<fields.length;j++){atualizar_fieldset(fields[j]);}var campos=form.getElementsByTagName("*");for(var j=0;j<campos.length;j++){atualizar_campo(campos.item(j));}var metas=form.getElementsByTagName("meta");for(var j=0;j<metas.length;j++){var meta=metas.item(j);var campo=document.getElementById(meta.getAttribute("name"));if(campo!=null){atualizar_info_campo(form,campo,meta.getAttribute("content"));}}}var topo=document.getElementById("voltar_topo");if(topo){topo.onclick=function(e){e=e?e:window.event;e.returnValue=false;window.scroll(0,0);return false;};}var menu=document.getElementById("menu");if(menu){var strongs=menu.getElementsByTagName("strong");for(var i=0;i<strongs.length;i++){objeto_movel(strongs.item(i),menu);}}}function atualizar_fieldset(fieldset){var legend=fieldset.getElementsByTagName("legend").item(0);botao=document.createElement("img");botao.setAttribute("src",wwwroot+"imgs/icones/menos.gif");botao.setAttribute("alt","Abrir/Fechar");botao.setAttribute("title","Abrir/Fechar");botao.style.backgroundColor="#FFFFFF";botao.style.cursor="pointer";botao.style.marginRight=".5em";botao.onclick=function(){var f=this.parentNode.parentNode;var c=f.firstChild;var fechou=false;while(c!=null){if(c.nodeType==1&&get_tag(c)!="legend"){if(c.getAttribute("display_anterior")!=null){c.style.display=c.getAttribute("display_anterior");c.removeAttribute("display_anterior");}else{c.setAttribute("display_anterior",c.style.display);c.style.display="none";fechou=true;}}c=c.nextSibling;}if(fechou){this.setAttribute("src",wwwroot+"imgs/icones/mais.gif");}else{this.setAttribute("src",wwwroot+"imgs/icones/menos.gif");}};espaco=document.createTextNode(" ");legend.insertBefore(botao,legend.firstChild);}function atualizar_campo(campo){switch(campo.nodeName){case "input":var type=campo.getAttribute("type");if(type=="password"){var aviso=document.createElement("span");aviso.style.display="none";definir_classe(aviso,"caps_lock");aviso.appendChild(document.createTextNode("Caps Lock"));campo.aviso=aviso;campo.checado=false;inserir_apos(campo.parentNode,aviso,campo);campo.onkeypress=function(e){var k=e.keyCode?e.keyCode:e.which;if(this.checado&&k==20){this.aviso.style.display=this.aviso.style.display=="block"?"none":"block";}this.checado=true;var shift=e.shiftKey;if(entre(k,65,90)||k==199){this.aviso.style.display=shift?"none":"block";}if(entre(k,97,122)||k==231){this.aviso.style.display=shift?"block":"none";}return true;};}else if(type=="hidden"){if(campo.getAttribute("name")=="id_progresso"){var form=campo.parentNode;while(form&&form.nodeName!="form"){form=form.parentNode;}var id=campo.getAttribute("value");form.setAttribute("id_progresso",id);form.onsubmit=function(){var url=wwwroot+"webservice/progresso.php?id="+this.getAttribute("id_progresso");window.open(url,"Progresso","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, width=400, height=250");return true;}}}break;}}function atualizar_info_campo(form,campo,id_campo){var labels=form.getElementsByTagName("label");var label=false;for(var i=0;i<labels.length;i++){var id_for="";try{id_for=labels.item(i).hasAttribute("for")?labels.item(i).getAttribute("for"):"";}catch(e){id_for=labels.item(i).getAttribute("htmlFor");}if(id_for==campo.id){label=labels.item(i);}}if(!label){return false;}campo.label=label;ultima_boia=false;campo.onfocus=function(){if(ultima_boia){ultima_boia.style.visibility="hidden";}var boia=this.label.parentNode.getElementsByTagName("img");if(boia&&boia.length>0){boia=boia.item(0);boia.style.visibility="visible";}else{var boia=document.createElement("img");boia.setAttribute("src",wwwroot+"imgs/icones/ajuda.gif");boia.setAttribute("title","Ajuda sobre o campo");boia.style.cursor="pointer";boia.style.display="block";boia.style.position="absolute";boia.style.marginLeft="-10px";label.style.clear="none";boia.id_campo=id_campo;boia.janela=false;boia.onclick=function(e){if(!this.janela){var pos=get_posicao_mouse(e);this.janela=new class_janela();var caixa=this.janela.criar_janela("Carregando...",pos.x,pos.y+5,300);atualizar_info_atributo(this.janela,campo,this.id_campo);}this.janela.abrir(document.getElementsByTagName("body").item(0));};if(label.getElementsByTagName("input").length>0){label.parentNode.appendChild(boia);}else{label.parentNode.insertBefore(boia,label);}}ultima_boia=boia;};return true;}function atualizar_info_atributo(janela,campo,id_campo){var that=this;this.ajax=new class_ajax();obj=janela.caixa;this.atualizar_descricao=function(){var xml=that.ajax.get_retorno("xml");if(xml.documentElement.getElementsByTagName("erro").length>0){janela.set_titulo("Erro");that.inserir_valor(obj,"Erro","Dados do campo não disponíveis");return;}var descricao=that.get_atributo(xml.documentElement,"descricao");janela.set_titulo("Ajuda do campo "+descricao);switch(campo.nodeName.toLowerCase()){case "select":that.inserir_valor(obj,"Instrução","Escolha um elemento da lista");return;case "input":switch(campo.getAttribute("text")){case "text":case "password":break;case "checkbox":that.inserir_valor(obj,"Instrução","Marque as opções desejadas");return;case "radio":that.inserir_valor(obj,"Instrução","Escolha uma opção");return;case "file":that.inserir_valor(obj,"Instrução","Escolha um arquivo");return;}break;case "textarea":break;}var tipo=that.get_atributo(xml.documentElement,"tipo");var minimo=that.get_atributo(xml.documentElement,"minimo");var maximo=that.get_atributo(xml.documentElement,"maximo");var obrigatorio=that.get_atributo(xml.documentElement,"pode_vazio")=='0';var unico=that.get_atributo(xml.documentElement,"unico")=='1';if(!minimo){minimo="indefinido";}if(!maximo){maximo="indefinido";}switch(tipo){case "int":that.inserir_valor(obj,"Tipo","Número Inteiro");that.inserir_valor(obj,"Intervalo","de "+minimo+" até "+maximo);if(obrigatorio){that.inserir_valor(obj,"Obrigatório","Sim");}if(unico){that.inserir_valor(obj,"Único no Sistema","Sim (não podem existir 2 iguais)");}break;case "float":that.inserir_valor(obj,"Tipo","Número Real");that.inserir_valor(obj,"Intervalo","de "+minimo+" até "+maximo);if(obrigatorio){that.inserir_valor(obj,"Obrigatório","Sim");}if(unico){that.inserir_valor(obj,"Único no Sistema","Sim (não podem existir 2 iguais)");}break;case "string":var validacao=xml.documentElement.getElementsByTagName("validacao");that.inserir_valor(obj,"Tipo","Texto");if(minimo==maximo){that.inserir_valor(obj,"Tamanho","exatamente "+minimo+" caracteres");}else{that.inserir_valor(obj,"Tamanho","entre "+minimo+" e "+maximo+" caracteres");}if(obrigatorio){that.inserir_valor(obj,"Obrigatório","Sim");}if(unico){that.inserir_valor(obj,"Único no Sistema","Sim (não podem existir 2 iguais)");}if(validacao.length){var instrucoes=that.get_atributo(validacao.item(0),"instrucoes");var exemplo=that.get_atributo(validacao.item(0),"exemplo");if(instrucoes){that.inserir_valor(obj,"Instruções",instrucoes);}if(exemplo){that.inserir_valor(obj,"Exemplo",exemplo);}}break;case "binario":that.inserir_valor(obj,"Tipo","Texto binário");that.inserir_valor(obj,"Tamanho","entre "+minimo+" e "+maximo);if(obrigatorio){that.inserir_valor(obj,"Obrigatório","Sim");}if(unico){that.inserir_valor(obj,"Único no Sistema","Sim (não podem existir 2 iguais)");}break;case "char":that.inserir_valor(obj,"Tipo","Caractere");if(obrigatorio){that.inserir_valor(obj,"Obrigatório","Sim");}if(unico){that.inserir_valor(obj,"Único no Sistema","Sim (não podem existir 2 iguais)");}break;case "bool":that.inserir_valor(obj,"Tipo","Sim ou Não");that.inserir_valor(obj,"Instruções","Marque a opção em caso positivo ou deixe desmarcada em caso negativo");break;case "data":var unico=that.get_atributo(xml.documentElement,"unico");that.inserir_valor(obj,"Tipo","Data");if(unico){that.inserir_valor(obj,"Único no Sistema","Sim (não podem existir 2 iguais)");}break;}};this.inserir_valor=function(obj,label,valor){var p=document.createElement("p");{var strong=document.createElement("strong");strong.appendChild(document.createTextNode(label+":"));p.appendChild(strong);p.appendChild(document.createTextNode(" "+valor));}obj.appendChild(p);};this.get_atributo=function(xml,atributo){var valor=xml.getElementsByTagName(atributo);if(!valor.length||!valor.item(0).hasChildNodes()){return false;}return valor.item(0).firstChild.nodeValue;};var link=wwwroot+"webservice/atributo.xml.php?id="+id_campo;this.ajax.set_funcao(that.atualizar_descricao);this.ajax.consultar("GET",link,true,null);}function entre(valor,minimo,maximo){return valor>=minimo&&valor<=maximo;}function class_tremer(item,offset){this.id=class_tremer.instancias.length;class_tremer.instancias[this.id]=this;this.obj_tremer=item.cloneNode(true);this.obj_original=item;this.offset=(offset>0)?offset:4;this.timer=null;this.i=0;this.tremer=function(tempo){if(this.obj_tremer.innerHTML.length<limite_tamanho){var pos=get_posicao(this.obj_original);this.obj_tremer.style.position="absolute";this.obj_tremer.style.margin="0px";this.obj_tremer.style.left=pos.x+"px";this.obj_tremer.style.top=pos.y+"px";this.obj_original.parentNode.replaceChild(this.obj_tremer,this.obj_original);this.timer=window.setInterval("class_tremer.instancias["+this.id+"].mover()",50);window.setTimeout("class_tremer.instancias["+this.id+"].parar_tremer()",tempo);}};this.mover=function(){try{this.i=1-this.i;var left=(this.i==1)?(-1*this.offset):this.offset;var pos=parseInt(this.obj_tremer.style.left)+left;this.obj_tremer.style.left=pos+"px";}catch(e){this.parar_tremer();}};this.parar_tremer=function(){clearInterval(this.timer);};}function class_piscar(item,vezes,passo){this.id=class_piscar.instancias.length;class_piscar.instancias[this.id]=this;this.obj_piscar=item;this.passo=(passo>0)?passo:0.1;this.opacity=(item.style.opacity!="")?parseFloat(item.style.opacity):1.0;this.timer=null;this.vezes=parseInt(vezes);this.sentido=false;this.piscar=function(){if(this.obj_piscar.innerHTML.length<limite_tamanho){this.obj_piscar.piscando=true;this.obj_piscar.style.opacity=parseFloat(this.opacity);this.sentido=false;this.timer=window.setInterval("class_piscar.instancias["+this.id+"].mudar()",50);}};this.mudar=function(){try{var f=parseFloat(this.obj_piscar.style.opacity);f=(this.sentido)?f+this.passo:f-this.passo;if(f<=0){f=0;this.obj_piscar.style.opacity=f;this.sentido=true;this.vezes--;}else if(f>=this.opacity){f=this.opacity;this.obj_piscar.style.opacity=f;this.sentido=false;}else{this.obj_piscar.style.opacity=f;}if((this.vezes<=0)&&(f==this.opacity)){this.parar_piscar();}}catch(e){this.parar_piscar();}};this.parar_piscar=function(){this.obj_piscar.piscando=false;this.sentido=false;clearInterval(this.timer);};}function fechar(obj){if(!obj.piscando){var obj_fechar=new class_fechar(obj);obj_fechar.dissolver(0.1);}}function class_fechar(item){this.id=class_fechar.instancias.length;class_fechar.instancias[this.id]=this;this.obj_fechar=item;this.passo=0.1;this.timer=null;this.dissolver=function(passo){if(passo>0){this.passo=parseFloat(passo);}if(this.obj_fechar.innerHTML.length<limite_tamanho){if(this.obj_fechar.style.opacity==""){this.obj_fechar.style.opacity=1.0;}this.timer=window.setInterval("class_fechar.instancias["+this.id+"].mudar_dissolver()",50);}else{this.obj_fechar.parentNode.removeChild(this.obj_fechar);delete this.obj_fechar;this.obj_fechar=null;}};this.mudar_dissolver=function(){this.obj_fechar.style.opacity-=this.passo;if(this.obj_fechar.style.opacity<=0){this.parar_timer();}};this.parar_timer=function(){clearInterval(this.timer);this.obj_fechar.parentNode.removeChild(this.obj_fechar);delete this.obj_fechar;this.obj_fechar=null;};}function set_foco(){try{for(var f=0;f<document.forms.length;f++){for(var i=0;i<document.forms[f].length;i++){var c=document.forms[f][i];if(c.getAttribute("type")!="hidden"&&!c.getAttribute("disabled")){c.focus();c.select();return;}}}}catch(e){}}function atualizar_hora(){var hl=document.getElementById("hora_local");if(!hl){return;}var pai=hl.parentNode;var nova_hl=document.createElement(hl.nodeName);nova_hl.id=hl.id;var hoje=new Date();var h=hoje.getHours();var m=hoje.getMinutes();var s=hoje.getSeconds();if(h<10){h="0"+h;}if(m<10){m="0"+m;}if(s<10){s="0"+s;}var texto=document.createTextNode(h+":"+m+":"+s);nova_hl.appendChild(texto);pai.replaceChild(nova_hl,hl);}function setcookie(nome,valor){var expires=new Date();expires.setDate(expires.getDate()+7);var c=nome+"="+encodeURIComponent(valor)+"; expires="+expires.toGMTString()+"; path="+path;if(!localhost){c+="; domain="+dominio;}document.cookie=c;};function getcookie(nome){var reMatchCookie=new RegExp("(?:; )?"+nome+"=([^;]*);?");return(reMatchCookie.test(document.cookie)?decodeURIComponent(RegExp.$1):null);};function mostrar_ajuda(link){var caixa=link.parentNode;var vet=caixa.getElementsByTagName("blockquote");if(!vet.length){return false;}var blockquote=vet[0];if(get_classe(blockquote)=="hide"){setcookie("expandir","1");definir_classe(caixa,"bloco_ajuda_aberto");definir_classe(blockquote,"visivel");link.setAttribute("title","Esconder Ajuda");}else{setcookie("expandir","0");definir_classe(caixa,"bloco_ajuda_fechado");definir_classe(blockquote,"hide");link.setAttribute("title","Expandir Ajuda");}link.removeAttribute("href");return false;}function definir_classe(obj,classe){obj.className=classe;}function adicionar_classe(obj,classe){var classes=get_classe(obj);if(classes==null){definir_classe(obj,classe);}else{var vt=classes.split(" ");var i=0;var ja_tem=false;while(i<vt.length){if(classe==vt[i]){ja_tem=true;break;}i++;}if(!ja_tem){classes=classes+" "+classe;definir_classe(obj,classe);}}}function remover_classe(obj,classe){if(classe==undefined){obj.removeAttribute("class");return;}var classes=get_classe(obj);if(classes!=null){var vt=classes.split(" ");var i=0;var vt2=new Array();while(i<vt.length){if(classe!=vt[i]){vt2.push(vt[i]);}i++;}if(vt2.length>=1){definir_classe(obj,vt2.join(" "));}else{obj.removeAttribute("class");}}}function possui_classe(obj,classe){var classes=get_classe(obj);if(classes!=null){var vt=classes.split(" ");var i=vt.length-1;while(i>=0){if(classe==vt[i]){return true;}i--;}}return false;}function get_classe(obj){if(obj.className){return obj.className;}else if(obj.getAttribute){return obj.getAttribute("class");}return null;}function get_tag(obj){return obj.nodeName.toLowerCase();}function limpar(obj){while(obj.hasChildNodes()){obj.removeChild(obj.firstChild);}}function marcar_checkbox(id){var f=document.getElementById(id);if(!f){return;}if(checkbox_marcados[id]==undefined){checkbox_marcados[id]=false;}var el=f.getElementsByTagName('input');for(var i=0;i<el.length;i++){if(el[i].type=='checkbox'&&el[i].disabled==false){el[i].checked=checkbox_marcados[id]?false:true;}}checkbox_marcados[id]=!checkbox_marcados[id];}function mudar(id){var obj=document.getElementById(id);if(!obj){return false;}if(get_classe(obj)=="hide"){definir_classe(obj,"bloco");}else{definir_classe(obj,"hide");}return false;}function mascara(e,input,tipo,blur,local){var valor=input.value;var exemplo="";var exp;var fim;local=local.toLowerCase();this.set_valido=function(valido,input){var vt_img=input.parentNode.getElementsByTagName("img");if(vt_img.length>0){var img=vt_img.item(0);}else{var img=document.createElement("img");}var src=wwwroot+"imgs/icones/"+(valido?"valido.gif":"invalido.gif");var alt=valido?"válido":"inválido";img.setAttribute("src",src);img.setAttribute("alt","campo "+alt);img.setAttribute("title","campo "+alt);if(vt_img.length==0){img.style.marginLeft="4px";img.style.float="left";img.style.position="absolute";input.style.width=(input.offsetWidth-30)+"px";input.parentNode.appendChild(img);}};switch(local.toLowerCase()){case "pt_br":case "pt_br.utf-8":case "portuguese_brazil.1252":switch(tipo){case "digitos":exemplo="000 ou 001 ou 002 ...";exp=/^[0-9]*$/;fim=/^[0-9]*$/;break;case "letras":exemplo="abc";exp=/^[A-Za-z]*$/;fim=/^[A-Za-z]*$/;break;case "moeda":exemplo="0 ou -0,12 ou 1000,23 ou -1000,30";exp=/^[-]?(0[,]?[0-9]{0,2}|[1-9]{1}[0-9]*[,]?[0-9]{0,2})?$/;fim=/^(0|[-]?0,[0-9]{1,2}|[-]?[1-9]{1}[0-9]*([,]{1}[0-9]{1,2})?)$/;break;case "int":exemplo="0 ou 1000 ou -1000";exp=/^(0|[-]?([1-9]{1}[0-9]*)?)$/;fim=/^(0|[-]?[1-9]{1}[0-9]*)$/;break;case "float":exemplo="0 ou -0,123 ou 1000,1 ou -1000,1";exp=/^[-]?(0[,]?[0-9]*|[1-9]{1}[0-9]*[,]?[0-9]*)?$/;fim=/^(0|[-]?0,[0-9]+|[-]?[1-9]{1}[0-9]*([,]{1}[0-9]+)?)$/;break;case "uint":exemplo="0 ou 1000";exp=/^(0|[1-9]{1}[0-9]*)$/;fim=/^(0|[1-9]{1}[0-9]*)$/;break;case "ufloat":exemplo="0 ou 0,1 ou 1000 ou 1000,1";exp=/^(0|0[,]?[0-9]*|[1-9]{1}[0-9]*[,]?[0-9]*)?$/;fim=/^(0|[1-9]{1}[0-9]*)([,]{1}[0-9]+)?$/;break;}break;default:return true;}if(valor.length==0){return true;}var re=new RegExp((blur==1)?fim:exp);var re_final=new RegExp(fim);this.set_valido(re_final.test(valor),input);if(!re.test(valor)){if(blur!=1){input.value=input.valor_antigo;}return false;}return true;}function ativar_timer_busca(input,dados){if(timer_busca){window.clearTimeout(timer_busca);}input_busca=input;timer_busca=setTimeout("buscar('"+dados+"')",1000);}function buscar(dados){if(!input_busca){return false;}var that=this;this.input=input_busca;this.div=input_busca.nextSibling;this.ajax=new class_ajax();this.url=wwwroot+"webservice/busca.xml.php?dados="+dados+"&busca="+input_busca.value;this.atualizar_itens=function(){var xml=that.ajax.get_retorno("xml");var resultados=xml.documentElement.getElementsByTagName("resultado");limpar(that.div);if(resultados.length==0){var msg=document.createTextNode("Resultado(s) Semelhante(s): nenhum");that.div.appendChild(msg);}else{var msg=document.createTextNode("Resultado(s) Semelhante(s): "+resultados.length);var select=document.createElement("select");select.setAttribute("size","7");select.onchange=function(){that.input.value=this.value;};var a=document.createElement("a");a.setAttribute("href","#");a.onclick=function(e){e=e?e:window.event;e.returnValue=false;limpar(that.div);that.div.style.display="none";that.input.focus();that.input.select();return false;};a.onkeypressed=a.onclick;var texto_fechar=document.createTextNode("Fechar");a.appendChild(texto_fechar);for(var i=0;i<resultados.length;i++){var valor=resultados.item(i).firstChild.nodeValue;var option=document.createElement("option");var texto=document.createTextNode(valor);option.appendChild(texto);option.setAttribute("value",valor);option.ondblclick=function(){limpar(that.div);that.div.style.display="none";that.input.focus();that.input.select();return false;};select.appendChild(option);}that.div.appendChild(msg);that.div.appendChild(select);that.div.appendChild(a);}return true;};this.consultar=function(){if(that.input.value.length>0){that.div.style.display="block";that.ajax.set_funcao(that.atualizar_itens);that.ajax.exibir_carregando(div);that.ajax.consultar("GET",that.url,true,null);}else{limpar(that.div);that.div.style.display="none";}return true;};this.consultar();return true;}function in_array(i,vet){for(var j in vet){if(i==j){return true;}}return false;}function checar_link(link){var url_link=link.getAttribute("href");if(url_link.indexOf("http://")==-1){url_link=wwwroot+url_link;}var url=wwwroot+"webservice/checar_link.xml.php?link="+encodeURIComponent(url_link);var ajax=new class_ajax();if(!ajax.xmlhttp){return;}ajax.set_funcao(function(){var xml=this.get_retorno("xml");if(!xml){return false;}try{var resultado=parseInt(xml.documentElement.firstChild.data);}catch(e){try{var resultado=parseInt(xml.documentElement.getElementsByTagName("resultado").item(0).firstChild.data);}catch(e2){return false;}}switch(resultado){case 0:case 1:break;case 2:link.style.color="#990000";link.style.textDecoration="line-through";var texto=document.createTextNode(" (link quebrado) ");var small=document.createElement("small");small.appendChild(texto);var novo=document.createElement("a");var busca=(link.getAttribute("title")!=null)?link.getAttribute("title"):link.getAttribute("href");novo.setAttribute("href","http://www.google.com.br/search?q="+encodeURIComponent(busca));novo.setAttribute("target","_blank");var texto_novo=document.createTextNode("Buscar no Google");novo.appendChild(texto_novo);small.appendChild(novo);if(link.nextSibling){link.parentNode.insertBefore(small,link.nextSibling);}else{link.parentNode.appendChild(small);}break;}return false;});ajax.consultar("GET",url,true,null,false);}function tirar_visibilidade(obj){if(obj.hasChildNodes()){var filhos=obj.getElementsByTagName("*");for(var i=0;i<filhos.length;i++){var filho=filhos.item(i);filho.style.visibility="hidden";tirar_visibilidade(filho);}}}function clonar_tag(obj){var item=document.createElement(get_tag(obj),obj.innerHTML);for(j=obj.attributes.length-1;j>=0;j--){item.setAttribute(obj.attributes.item(j).name,obj.attributes.item(j).value);}return item;}function juntar_funcoes(velho,novo){if(!velho){return novo;}velho=velho.toString();novo=novo.toString();var p1=velho.indexOf("{")+1;var p2=velho.lastIndexOf("}");velho=velho.substring(p1,p2);var p1=novo.indexOf("{")+1;var p2=novo.lastIndexOf("}");novo=novo.substring(p1,p2);var saida=new Function(novo+velho);return saida;}function get_conteudo(url){var ajax=new class_ajax();if(!ajax.xmlhttp){return "";}ajax.consultar("GET",url,false,null);return ajax.get_retorno("text");}